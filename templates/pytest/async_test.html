import pytest
import asyncio
from unittest.mock import AsyncMock, patch

class Test{{ function_name }}Async:
    
    @pytest.mark.asyncio
    async def test_{{ test_name }}_{{ test_category }}(self):
        """{{ description }}"""
        {% for input in inputs %}
        result = await {{ function_name }}({{ input }})
        assert result is not None
        {% endfor %}
    
    @pytest.mark.asyncio
    async def test_{{ test_name }}_exception_handling(self):
        """Test async exception handling"""
        # Test with invalid inputs
        with pytest.raises((TypeError, ValueError)):
            await {{ function_name }}(None)
        
        with pytest.raises((TypeError, ValueError)):
            await {{ function_name }}()
    
    @pytest.mark.asyncio 
    async def test_{{ test_name }}_timeout(self):
        """Test async timeout scenarios"""
        try:
            # Test with reasonable timeout
            result = await asyncio.wait_for({{ function_name }}(), timeout=5.0)
            assert result is not None
        except asyncio.TimeoutError:
            # Timeout is acceptable for some functions
            assert True
    
    @pytest.mark.asyncio
    async def test_{{ test_name }}_concurrent_execution(self):
        """Test concurrent execution"""
        tasks = [
            {{ function_name }}(f"input_{i}") 
            for i in range(3)
        ]
        
        results = await asyncio.gather(*tasks, return_exceptions=True)
        assert len(results) == 3
        
        # Check that we got either results or expected exceptions
        for result in results:
            assert result is not None or isinstance(result, Exception)
    
    @pytest.mark.asyncio
    async def test_{{ test_name }}_cancellation(self):
        """Test task cancellation"""
        task = asyncio.create_task({{ function_name }}())
        
        # Let it run briefly then cancel
        await asyncio.sleep(0.01)
        task.cancel()
        
        with pytest.raises(asyncio.CancelledError):
            await task